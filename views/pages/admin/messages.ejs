<div class="page-container admin-landing">
  <div class="page-header">
    <h1>Contact Messages (<%= messages.length %>)</h1>
    <p class="text-muted">All contact form submissions from the website.</p>
    <div style="margin-top: 12px; display: flex; gap: 8px;">
      <a href="/admin/landing" class="btn btn-secondary btn-sm">Images</a>
      <a href="/admin/specialists" class="btn btn-secondary btn-sm">Specialists</a>
      <a href="/admin/video" class="btn btn-secondary btn-sm">Video</a>
      <a href="/admin/messages" class="btn btn-primary btn-sm">Messages</a>
    </div>
  </div>

  <% if (messages.length === 0) { %>
    <div class="admin-asset-card" style="text-align: center; padding: 48px;">
      <i data-lucide="inbox" style="width: 48px; height: 48px; color: var(--text-muted); margin-bottom: 16px;"></i>
      <h3 style="margin-bottom: 8px;">No messages yet</h3>
      <p class="text-muted">Messages from the contact form will appear here.</p>
    </div>
  <% } else { %>
    <div style="display: flex; flex-direction: column; gap: 16px;">
      <% messages.forEach(msg => { %>
        <div class="admin-asset-card" style="flex-direction: column;">
          <div style="display: flex; justify-content: space-between; align-items: flex-start; gap: 12px; flex-wrap: wrap;">
            <div style="flex: 1; min-width: 200px;">
              <div style="display: flex; align-items: center; gap: 8px; margin-bottom: 6px;">
                <span style="display: inline-block; padding: 2px 8px; font-size: 11px; font-weight: 600; border-radius: 6px;
                  background: <%= msg.status === 'new' ? '#dcfce7' : msg.status === 'read' ? '#dbeafe' : msg.status === 'replied' ? '#f3e8ff' : '#f1f5f9' %>;
                  color: <%= msg.status === 'new' ? '#16a34a' : msg.status === 'read' ? '#2563eb' : msg.status === 'replied' ? '#7c3aed' : '#64748b' %>;">
                  <%= msg.status.toUpperCase() %>
                </span>
                <span class="text-muted" style="font-size: 12px;"><%= new Date(msg.createdAt).toLocaleDateString('fr-FR', { day: 'numeric', month: 'short', year: 'numeric', hour: '2-digit', minute: '2-digit' }) %></span>
              </div>
              <h3 style="font-size: 16px; font-weight: 600; margin: 0 0 4px 0;"><%= msg.name %></h3>
              <p style="font-size: 13px; color: var(--accent-primary); margin: 0 0 4px 0;"><%= msg.email %></p>
              <% if (msg.subject) { %>
                <p style="font-size: 14px; font-weight: 500; margin: 0 0 4px 0;">Sujet: <%= msg.subject %></p>
              <% } %>
              <% if (msg.category) { %>
                <p style="font-size: 12px; color: var(--text-muted); margin: 0 0 8px 0;">Cat√©gorie: <%= msg.category %></p>
              <% } %>
              <% if (msg.message) { %>
                <p style="font-size: 14px; color: var(--text-secondary); line-height: 1.6; margin: 8px 0 0 0; white-space: pre-wrap;"><%= msg.message %></p>
              <% } %>
            </div>
            <div style="display: flex; gap: 6px; flex-shrink: 0;">
              <form action="/admin/messages/<%= msg._id %>/status" method="POST" style="display: inline;">
                <% if (msg.status === 'new') { %>
                  <input type="hidden" name="status" value="read">
                  <button type="submit" class="btn btn-secondary btn-sm" title="Mark as read">
                    <i data-lucide="eye"></i>
                  </button>
                <% } else if (msg.status === 'read') { %>
                  <input type="hidden" name="status" value="replied">
                  <button type="submit" class="btn btn-secondary btn-sm" title="Mark as replied">
                    <i data-lucide="check"></i>
                  </button>
                <% } else { %>
                  <input type="hidden" name="status" value="archived">
                  <button type="submit" class="btn btn-secondary btn-sm" title="Archive">
                    <i data-lucide="archive"></i>
                  </button>
                <% } %>
              </form>
              <a href="mailto:<%= msg.email %>?subject=Re: <%= encodeURIComponent(msg.subject || 'Votre demande CraftyCrib') %>" class="btn btn-primary btn-sm" title="Reply by email">
                <i data-lucide="reply"></i>
              </a>
              <form action="/admin/messages/<%= msg._id %>/delete" method="POST" style="display: inline;" onsubmit="return confirm('Delete this message?')">
                <button type="submit" class="btn btn-secondary btn-sm" title="Delete" style="color: #ef4444;">
                  <i data-lucide="trash-2"></i>
                </button>
              </form>
            </div>
          </div>
        </div>
      <% }) %>
    </div>
  <% } %>
</div>

