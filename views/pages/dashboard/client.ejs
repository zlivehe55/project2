<!-- Dashboard Header -->
<div class="dashboard-page-header">
  <div>
    <h1>Welcome back, <%= user.firstName %>! ðŸ‘‹</h1>
    <p class="subtitle">Here's an overview of your interior design projects</p>
  </div>
  <a href="/projects/new" class="btn btn-primary">
    <i data-lucide="plus"></i>
    New Project
  </a>
</div>

<!-- Stats Row -->
<div class="stats-row">
  <div class="stat-card">
    <div class="stat-icon green">
      <i data-lucide="folder"></i>
    </div>
    <div class="stat-content">
      <div class="stat-value"><%= stats.totalProjects %></div>
      <div class="stat-label">Total Projects</div>
    </div>
  </div>
  
  <div class="stat-card">
    <div class="stat-icon purple">
      <i data-lucide="sparkles"></i>
    </div>
    <div class="stat-content">
      <div class="stat-value"><%= stats.totalVariants %></div>
      <div class="stat-label">AI Designs Generated</div>
    </div>
  </div>
  
  <div class="stat-card">
    <div class="stat-icon orange">
      <i data-lucide="clock"></i>
    </div>
    <div class="stat-content">
      <div class="stat-value"><%= stats.inProgress %></div>
      <div class="stat-label">In Progress</div>
    </div>
  </div>
  
  <div class="stat-card">
    <div class="stat-icon blue">
      <i data-lucide="check-circle"></i>
    </div>
    <div class="stat-content">
      <div class="stat-value"><%= stats.completedDesigns %></div>
      <div class="stat-label">Completed</div>
    </div>
  </div>
</div>

<!-- Main Dashboard Grid -->
<div class="dashboard-grid">
  <!-- Left Column - Projects -->
  <div>
    <!-- AI Credits Card -->
    <div class="credits-card">
      <div class="credits-header">
        <h4><i data-lucide="zap"></i> AI Credits</h4>
        <a href="/pricing" class="btn btn-sm btn-ghost">Get More</a>
      </div>
      <div class="credits-value"><%= user.isPremium ? 'âˆž' : '3' %></div>
      <div class="credits-label"><%= user.isPremium ? 'Unlimited generations' : 'Free generations remaining' %></div>
      <% if (!user.isPremium) { %>
        <div class="credits-bar">
          <div class="credits-bar-fill" style="width: 100%"></div>
        </div>
      <% } %>
    </div>
    
    <!-- Recent Projects -->
    <div class="dashboard-section">
      <div class="section-header">
        <h2>Recent Projects</h2>
        <a href="/projects" class="btn btn-sm btn-ghost">View All</a>
      </div>
      
      <% if (projects && projects.length > 0) { %>
        <div class="projects-list">
          <% projects.forEach(project => { %>
            <a href="/projects/<%= project._id %>" class="project-item">
              <div class="project-thumb">
                <% if (project.designVariants && project.designVariants.length > 0) { %>
                  <img src="<%= project.designVariants[project.designVariants.length - 1].imageUrl || project.designVariants[project.designVariants.length - 1].thumbnailUrl %>" alt="<%= project.title %>">
                <% } else if (project.originalImages && project.originalImages.length > 0) { %>
                  <img src="<%= project.originalImages[0].url %>" alt="<%= project.title %>">
                <% } else { %>
                  <div class="project-thumb-placeholder">
                    <i data-lucide="image"></i>
                  </div>
                <% } %>
              </div>
              <div class="project-details">
                <h3><%= project.title %></h3>
                <div class="project-meta">
                  <span><i data-lucide="home"></i> <%= project.roomType %></span>
                  <% if (project.style) { %>
                    <span><i data-lucide="palette"></i> <%= project.style %></span>
                  <% } %>
                </div>
                <span class="project-status <%= project.status %>"><%= project.status %></span>
              </div>
              <div class="project-actions">
                <% if (project.status === 'draft' || project.status === 'pending') { %>
                  <span class="btn btn-sm btn-primary">
                    <i data-lucide="sparkles"></i> Generate
                  </span>
                <% } else { %>
                  <span class="btn btn-sm btn-secondary">View</span>
                <% } %>
              </div>
            </a>
          <% }) %>
        </div>
      <% } else { %>
        <div class="section-content">
          <div class="empty-state">
            <div class="empty-state-icon">
              <i data-lucide="folder-plus"></i>
            </div>
            <h3>No projects yet</h3>
            <p>Create your first project and let AI transform your space!</p>
            <a href="/projects/new" class="btn btn-primary">
              <i data-lucide="plus"></i>
              Create Project
            </a>
          </div>
        </div>
      <% } %>
    </div>
  </div>
  
  <!-- Right Column - Quick Actions & Activity -->
  <div>
    <!-- Quick Actions -->
    <div class="dashboard-section" style="margin-bottom: var(--spacing-lg);">
      <div class="section-header">
        <h2>Quick Actions</h2>
      </div>
      <div class="section-content">
        <div class="quick-actions-grid">
          <a href="/projects/new" class="quick-action">
            <i data-lucide="plus-circle"></i>
            <span>New Project</span>
          </a>
          <a href="/contractors" class="quick-action">
            <i data-lucide="hard-hat"></i>
            <span>Find Contractors</span>
          </a>
          <a href="/dashboard/messages" class="quick-action">
            <i data-lucide="message-square"></i>
            <span>Messages</span>
          </a>
          <a href="/dashboard/settings" class="quick-action">
            <i data-lucide="settings"></i>
            <span>Settings</span>
          </a>
        </div>
      </div>
    </div>
    
    <!-- Recent Activity -->
    <div class="dashboard-section">
      <div class="section-header">
        <h2>Recent Activity</h2>
      </div>
      <div class="activity-feed">
        <% if (recentActivity && recentActivity.length > 0) { %>
          <% recentActivity.forEach(activity => { %>
            <div class="activity-item">
              <div class="activity-icon">
                <% if (activity.type === 'design') { %>
                  <i data-lucide="sparkles" style="color: var(--accent-primary);"></i>
                <% } else if (activity.type === 'message') { %>
                  <i data-lucide="message-square" style="color: #3b82f6;"></i>
                <% } else { %>
                  <i data-lucide="folder" style="color: #a855f7;"></i>
                <% } %>
              </div>
              <div class="activity-content">
                <p><%= activity.message %></p>
                <span class="activity-time"><%= activity.time %></span>
              </div>
            </div>
          <% }) %>
        <% } else { %>
          <div class="section-content">
            <p style="color: var(--text-muted); text-align: center; padding: var(--spacing-lg);">No recent activity</p>
          </div>
        <% } %>
      </div>
    </div>
    
    <!-- Upgrade CTA -->
    <% if (!user.isPremium) { %>
      <div class="dashboard-section" style="background: linear-gradient(135deg, rgba(124, 58, 237, 0.2), rgba(168, 85, 247, 0.1)); border-color: rgba(124, 58, 237, 0.3);">
        <div class="section-content" style="text-align: center; padding: var(--spacing-xl);">
          <div style="font-size: 2.5rem; margin-bottom: var(--spacing-md);">âœ¨</div>
          <h3 style="margin-bottom: var(--spacing-sm);">Upgrade to Pro</h3>
          <p style="color: var(--text-secondary); margin-bottom: var(--spacing-lg); font-size: 0.9rem;">
            Get unlimited AI generations, HD renders, and priority contractor matching.
          </p>
          <a href="/pricing" class="btn btn-primary">
            <i data-lucide="crown"></i>
            Upgrade Now
          </a>
        </div>
      </div>
    <% } %>
  </div>
</div>
